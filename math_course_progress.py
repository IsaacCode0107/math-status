import pandas as pd
from datetime import datetime

# èª²ç¨‹è³‡æ–™çµæ§‹
course_data = {
    "ç¬¬ä¸‰å†Š ç¬¬ä¸€ç«  ä¸‰è§’å‡½æ•¸": [
        {"code": "1-1_ä¸»é¡Œ1", "name": "å¼§åº¦é‡(A+Bç‰ˆ)", "time": "40:39", "status": "å·²å®Œæˆ", "note": "åŸºç¤æ¦‚å¿µ"},
        {"code": "1-1_ä¸»é¡Œ2", "name": "æ‰‡å½¢å¼§é•·èˆ‡é¢ç©(A+Bç‰ˆ)", "time": "15:20", "status": "å·²å®Œæˆ", "note": "æ‡‰ç”¨è¨ˆç®—"},
        {"code": "1-1_ä¸»é¡Œ3", "name": "ä¸‰è§’å‡½æ•¸çš„åœ–å½¢(A+Bç‰ˆ)", "time": "01:12:32", "status": "å·²å®Œæˆ", "note": "åœ–å½¢åˆ†æ"},
        {"code": "1-1_ä¸»é¡Œ4", "name": "ä¸‰è§’æ–¹ç¨‹å¼(A+Bç‰ˆ)", "time": "23:55", "status": "é€²è¡Œä¸­", "note": "æ–¹ç¨‹æ±‚è§£"},
        {"code": "1-1_ä¸»é¡Œ5", "name": "ä¸‰è§’ä¸ç­‰å¼(A+Bç‰ˆ)", "time": "14:26", "status": "æœªé–‹å§‹", "note": "ä¸ç­‰å¼è§£æ³•"},
        {"code": "1-1_ä¸»é¡Œ6", "name": "ä¸‰è§’å‡½æ•¸çš„æ¥µå€¼(A+Bç‰ˆ)", "time": "03:37", "status": "æœªé–‹å§‹", "note": "æ¥µå€¼å•é¡Œ"},
        {"code": "1-1_ä¸»é¡Œ7", "name": "ä¸‰è§’å‡½æ•¸çš„æ‡‰ç”¨(A+Bç‰ˆ)", "time": "13:39", "status": "æœªé–‹å§‹", "note": "å¯¦éš›æ‡‰ç”¨"},
        {"code": "1-2_ä¸»é¡Œ1", "name": "å’Œå·®è§’å…¬å¼(Aç‰ˆ)", "time": "01:19:38", "status": "æœªé–‹å§‹", "note": "å…¬å¼æ¨å°"},
        {"code": "1-2_ä¸»é¡Œ2", "name": "å¹³æ–¹å·®(èª²å¤–è£œå……)(Aç‰ˆ)", "time": "06:08", "status": "æœªé–‹å§‹", "note": "è£œå……å…§å®¹"},
        {"code": "1-2_ä¸»é¡Œ3", "name": "æ­£åˆ‡çš„å’Œå·®è§’(Aç‰ˆ)", "time": "27:06", "status": "æœªé–‹å§‹", "note": "æ­£åˆ‡å…¬å¼"},
        {"code": "1-2_ä¸»é¡Œ4", "name": "äºŒå€è§’(Aç‰ˆ)", "time": "28:12", "status": "æœªé–‹å§‹", "note": "å€è§’å…¬å¼"},
        {"code": "1-2_ä¸»é¡Œ5", "name": "äºŒå€è§’(Aç‰ˆ)", "time": "21:51", "status": "æœªé–‹å§‹", "note": "å»¶çºŒå…§å®¹"},
        {"code": "1-2_ä¸»é¡Œ6", "name": "åŠè§’å…¬å¼(Aç‰ˆ)", "time": "26:03", "status": "æœªé–‹å§‹", "note": "åŠè§’æ¨å°"},
        {"code": "1-3_ä¸»é¡Œ1", "name": "æ­£é¤˜å¼¦çš„ç–Šåˆ(Aç‰ˆ)", "time": "40:16", "status": "æœªé–‹å§‹", "note": "å‡½æ•¸ç–Šåˆ"},
        {"code": "1-3_ä¸»é¡Œ2", "name": "æ­£é¤˜å¼¦ç–Šåˆçš„æ¥µå€¼(Aç‰ˆ)", "time": "44:27", "status": "æœªé–‹å§‹", "note": "æ¥µå€¼è¨ˆç®—"},
        {"code": "1-3_ä¸»é¡Œ3", "name": "æ­£é¤˜å¼¦ç–Šåˆçš„æ‡‰ç”¨å•é¡Œ(Aç‰ˆ)", "time": "28:05", "status": "æœªé–‹å§‹", "note": "æ‡‰ç”¨é¡Œå‹"}
    ],
    "ç¬¬ä¸‰å†Š ç¬¬äºŒç«  æŒ‡æ•¸èˆ‡å°æ•¸å‡½æ•¸": [
        {"code": "2-1_ä¸»é¡Œ1", "name": "æŒ‡æ•¸å‡½æ•¸çš„åœ–å½¢(A+Bç‰ˆ)", "time": "42:24", "status": "æœªé–‹å§‹", "note": "åœ–å½¢æ€§è³ª"},
        {"code": "2-1_ä¸»é¡Œ2", "name": "æŒ‡æ•¸æ¯”å¤§å°(A+Bç‰ˆ)", "time": "09:01", "status": "æœªé–‹å§‹", "note": "å¤§å°æ¯”è¼ƒ"},
        {"code": "2-1_ä¸»é¡Œ3", "name": "æŒ‡æ•¸æ–¹ç¨‹å¼èˆ‡ä¸ç­‰å¼(A+Bç‰ˆ)", "time": "09:01", "status": "æœªé–‹å§‹", "note": "æ–¹ç¨‹ä¸ç­‰å¼"},
        {"code": "2-1_ä¸»é¡Œ4", "name": "æŒ‡æ•¸å‡½æ•¸çš„æ¥µå€¼(A+Bç‰ˆ)", "time": "11:03", "status": "æœªé–‹å§‹", "note": "æ¥µå€¼å•é¡Œ"},
        {"code": "2-1_ä¸»é¡Œ5", "name": "æŒ‡æ•¸å‡½æ•¸çš„æ‡‰ç”¨(A+Bç‰ˆ)", "time": "08:15", "status": "æœªé–‹å§‹", "note": "å¯¦éš›æ‡‰ç”¨"},
        {"code": "2-2_ä¸»é¡Œ1", "name": "å°æ•¸çš„å®šç¾©(A+Bç‰ˆ)", "time": "14:32", "status": "æœªé–‹å§‹", "note": "åŸºæœ¬å®šç¾©"},
        {"code": "2-2_ä¸»é¡Œ2", "name": "å°æ•¸å¾‹(A+Bç‰ˆ)", "time": "01:04:23", "status": "æœªé–‹å§‹", "note": "å°æ•¸é‹ç®—å¾‹"},
        {"code": "2-2_ä¸»é¡Œ3", "name": "å°æ•¸æ–¹ç¨‹(A+Bç‰ˆ)", "time": "21:12", "status": "æœªé–‹å§‹", "note": "æ–¹ç¨‹æ±‚è§£"},
        {"code": "2-2_ä¸»é¡Œ4", "name": "ç§‘å­¸è¨˜è™Ÿèˆ‡å¸¸ç”¨å°æ•¸(A+Bç‰ˆ)", "time": "24:07", "status": "æœªé–‹å§‹", "note": "ç§‘å­¸æ‡‰ç”¨"},
        {"code": "2-3_ä¸»é¡Œ1", "name": "å°æ•¸å‡½æ•¸çš„åœ–å½¢(A+Bç‰ˆ)", "time": "44:59", "status": "æœªé–‹å§‹", "note": "åœ–å½¢åˆ†æ"},
        {"code": "2-3_ä¸»é¡Œ2", "name": "å°æ•¸æ¯”å¤§å°(A+Bç‰ˆ)", "time": "12:06", "status": "æœªé–‹å§‹", "note": "å¤§å°æ¯”è¼ƒ"},
        {"code": "2-3_ä¸»é¡Œ3", "name": "å°æ•¸ä¸ç­‰å¼(A+Bç‰ˆ)", "time": "23:56", "status": "æœªé–‹å§‹", "note": "ä¸ç­‰å¼è§£æ³•"},
        {"code": "2-3_ä¸»é¡Œ4", "name": "å°æ•¸æ±‚æ¥µå€¼(A+Bç‰ˆ)", "time": "07:08", "status": "æœªé–‹å§‹", "note": "æ¥µå€¼è¨ˆç®—"},
        {"code": "2-3_ä¸»é¡Œ5", "name": "å°æ•¸æ‡‰ç”¨å•é¡Œ(A+Bç‰ˆ)", "time": "33:57", "status": "å·²å®Œæˆ", "note": "æ‡‰ç”¨é¡Œå‹"}
    ],
    "ç¬¬ä¸‰å†Š ç¬¬ä¸‰ç«  å¹³é¢å‘é‡": [
        {"code": "3-1_ä¸»é¡Œ1", "name": "å¹³é¢å‘é‡çš„å¹¾ä½•è¡¨ç¤ºæ³•(A+Bç‰ˆ)", "time": "05:53", "status": "æœªé–‹å§‹", "note": "å¹¾ä½•è¡¨ç¤º"},
        {"code": "3-1_ä¸»é¡Œ2", "name": "å¹³é¢å‘é‡çš„åº§æ¨™è¡¨ç¤ºæ³•(A+Bç‰ˆ)", "time": "14:51", "status": "æœªé–‹å§‹", "note": "åº§æ¨™è¡¨ç¤º"},
        {"code": "3-1_ä¸»é¡Œ3", "name": "å‘é‡çš„é‹ç®—(A+Bç‰ˆ)", "time": "24:45", "status": "å·²å®Œæˆ", "note": "åŸºæœ¬é‹ç®—"},
        {"code": "3-1_ä¸»é¡Œ4", "name": "å‘é‡çš„ç·šæ€§çµ„åˆ(A+Bç‰ˆ)", "time": "28:52", "status": "æœªé–‹å§‹", "note": "ç·šæ€§çµ„åˆ"},
        {"code": "3-1_ä¸»é¡Œ5", "name": "å…±ç·šç†è«–(A+Bç‰ˆ)", "time": "35:00", "status": "æœªé–‹å§‹", "note": "å…±ç·šæ€§è³ª"},
        {"code": "3-1_ä¸»é¡Œ6", "name": "é¢ç©æ¯”(A+Bç‰ˆ)", "time": "07:25", "status": "æœªé–‹å§‹", "note": "é¢ç©è¨ˆç®—"},
        {"code": "3-1_ä¸»é¡Œ7", "name": "æ–œåº§æ¨™(A+Bç‰ˆ)", "time": "19:00", "status": "æœªé–‹å§‹", "note": "åº§æ¨™ç³»çµ±"},
        {"code": "3-2_ä¸»é¡Œ1", "name": "å…§ç©(A+Bç‰ˆ)", "time": "26:00", "status": "æœªé–‹å§‹", "note": "å…§ç©é‹ç®—"},
        {"code": "3-2_ä¸»é¡Œ2", "name": "å…§ç©çš„æ€§è³ª(A+Bç‰ˆ)", "time": "14:19", "status": "æœªé–‹å§‹", "note": "æ€§è³ªæ¢è¨"},
        {"code": "3-2_ä¸»é¡Œ3", "name": "æ­£å°„å½±(A+Bç‰ˆ)", "time": "26:11", "status": "æœªé–‹å§‹", "note": "æŠ•å½±è¨ˆç®—"},
        {"code": "3-2_ä¸»é¡Œ4", "name": "ç›´ç·šåƒæ•¸å¼(A+Bç‰ˆ)", "time": "27:25", "status": "æœªé–‹å§‹", "note": "åƒæ•¸æ–¹ç¨‹"},
        {"code": "3-2_ä¸»é¡Œ5", "name": "ç›´ç·šçš„å¤¾è§’(A+Bç‰ˆ)", "time": "10:36", "status": "æœªé–‹å§‹", "note": "è§’åº¦è¨ˆç®—"},
        {"code": "3-2_ä¸»é¡Œ6", "name": "æŸ¯è¥¿ä¸ç­‰å¼(Aç‰ˆ)", "time": "26:59", "status": "æœªé–‹å§‹", "note": "ä¸ç­‰å¼ç†è«–"},
        {"code": "3-3_ä¸»é¡Œ1", "name": "å‘é‡çš„é¢ç©å…¬å¼(Aç‰ˆ)", "time": "18:09", "status": "æœªé–‹å§‹", "note": "é¢ç©å…¬å¼"},
        {"code": "3-3_ä¸»é¡Œ2", "name": "äºŒéšè¡Œåˆ—å¼(Aç‰ˆ)", "time": "29:15", "status": "æœªé–‹å§‹", "note": "è¡Œåˆ—å¼è¨ˆç®—"},
        {"code": "3-3_ä¸»é¡Œ3", "name": "å…‹æ‹‰ç‘ªå…¬å¼(Aç‰ˆ)", "time": "12:17", "status": "æœªé–‹å§‹", "note": "ç·šæ€§æ–¹ç¨‹çµ„"},
        {"code": "3-3_ä¸»é¡Œ4", "name": "äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹çµ„çš„å‘é‡è§€é»(Aç‰ˆ)", "time": "12:02", "status": "æœªé–‹å§‹", "note": "å‘é‡è§€é»"}
    ],
    "ç¬¬å››å†Š ç¬¬ä¸€ç«  ç©ºé–“å‘é‡": [
        {"code": "1-1_ä¸»é¡Œ1", "name": "ç©ºé–“æ¦‚å¿µ(A+Bç‰ˆ)", "time": "23:07", "status": "æœªé–‹å§‹", "note": "åŸºç¤æ¦‚å¿µ"},
        {"code": "1-1_ä¸»é¡Œ2", "name": "äºŒé¢è§’(A+Bç‰ˆ)", "time": "30:00", "status": "æœªé–‹å§‹", "note": "è§’åº¦è¨ˆç®—"},
        {"code": "1-1_ä¸»é¡Œ3", "name": "ç«‹é«”åœ–å½¢è¨ˆç®—(A+Bç‰ˆ)", "time": "14:50", "status": "æœªé–‹å§‹", "note": "ç«‹é«”å¹¾ä½•"},
        {"code": "1-2_ä¸»é¡Œ1", "name": "ç©ºé–“åæ¨™ç³»(A+Bç‰ˆ)", "time": "32:39", "status": "æœªé–‹å§‹", "note": "åæ¨™ç³»çµ±"},
        {"code": "1-2_ä¸»é¡Œ2", "name": "ç©ºé–“å‘é‡çš„è¡¨ç¤ºæ³•(A+Bç‰ˆ)", "time": "25:52", "status": "æœªé–‹å§‹", "note": "å‘é‡è¡¨ç¤º"},
        {"code": "1-2_ä¸»é¡Œ3", "name": "ç©ºé–“å‘é‡çš„ç·šæ€§çµ„åˆ(A+Bç‰ˆ)", "time": "11:01", "status": "æœªé–‹å§‹", "note": "ç·šæ€§é‹ç®—"},
        {"code": "1-3_ä¸»é¡Œ1", "name": "ç©ºé–“å‘é‡çš„å…§ç©(Aç‰ˆ)", "time": "21:25", "status": "æœªé–‹å§‹", "note": "å…§ç©è¨ˆç®—"},
        {"code": "1-3_ä¸»é¡Œ2", "name": "æŸ¯è¥¿ä¸ç­‰å¼(Aç‰ˆ)", "time": "21:58", "status": "æœªé–‹å§‹", "note": "ä¸ç­‰å¼"},
        {"code": "1-4_ä¸»é¡Œ1", "name": "å¤–ç©(Aç‰ˆ)", "time": "18:27", "status": "æœªé–‹å§‹", "note": "å¤–ç©é‹ç®—"},
        {"code": "è£œå……", "name": "å…§ç©èˆ‡å¤–ç©æ¯”è¼ƒ", "time": "06:34", "status": "æœªé–‹å§‹", "note": "æ¦‚å¿µæ¯”è¼ƒ"},
        {"code": "1-4_ä¸»é¡Œ2", "name": "ç©ºé–“å‘é‡æ±‚é«”ç©(Aç‰ˆ)", "time": "04:57", "status": "æœªé–‹å§‹", "note": "é«”ç©è¨ˆç®—"},
        {"code": "1-4_ä¸»é¡Œ3", "name": "ä¸‰éšè¡Œåˆ—å¼(Aç‰ˆ)", "time": "24:50", "status": "æœªé–‹å§‹", "note": "è¡Œåˆ—å¼"},
        {"code": "1-4_ä¸»é¡Œ4", "name": "ä¸‰éšè¡Œåˆ—å¼çš„æ‡‰ç”¨(Aç‰ˆ)", "time": "12:44", "status": "æœªé–‹å§‹", "note": "æ‡‰ç”¨è¨ˆç®—"},
        {"code": "æ•¸Bè£œå……", "name": "å¦‚ä½•åˆ¤æ–·åœ“éŒæˆªç—•", "time": "04:27", "status": "æœªé–‹å§‹", "note": "å¹¾ä½•åˆ¤æ–·"},
        {"code": "æ•¸Bè£œå……", "name": "çƒé¢èˆ‡ç¶“ç·¯åº¦", "time": "20:27", "status": "æœªé–‹å§‹", "note": "çƒé¢å¹¾ä½•"}
    ],
    "ç¬¬å››å†Šç¬¬äºŒç«  ç©ºé–“çš„å¹³é¢èˆ‡ç›´ç·š(Aç‰ˆ)": [
        {"code": "2-1_ä¸»é¡Œ1", "name": "å¹³é¢æ–¹ç¨‹å¼", "time": "24:59", "status": "æœªé–‹å§‹", "note": "æ–¹ç¨‹å»ºç«‹"},
        {"code": "2-1_ä¸»é¡Œ2", "name": "å¹³é¢çš„æˆªè·å¼", "time": "18:42", "status": "æœªé–‹å§‹", "note": "æˆªè·è¡¨ç¤º"},
        {"code": "2-1_ä¸»é¡Œ3", "name": "å¹³é¢çš„å¤¾è§’", "time": "09:30", "status": "æœªé–‹å§‹", "note": "è§’åº¦è¨ˆç®—"},
        {"code": "2-1_ä¸»é¡Œ4", "name": "é»åˆ°å¹³é¢çš„è·é›¢", "time": "24:21", "status": "æœªé–‹å§‹", "note": "è·é›¢å…¬å¼"},
        {"code": "2-2_ä¸»é¡Œ1", "name": "ç›´ç·šæ–¹ç¨‹å¼", "time": "37:02", "status": "æœªé–‹å§‹", "note": "æ–¹ç¨‹å»ºç«‹"},
        {"code": "2-2_ä¸»é¡Œ2", "name": "ç›´ç·šèˆ‡å¹³é¢", "time": "29:32", "status": "æœªé–‹å§‹", "note": "é—œä¿‚åˆ†æ"},
        {"code": "2-2_ä¸»é¡Œ3", "name": "é»èˆ‡ç›´ç·š", "time": "06:50", "status": "æœªé–‹å§‹", "note": "ä½ç½®é—œä¿‚"},
        {"code": "2-2_ä¸»é¡Œ4", "name": "ç›´ç·šèˆ‡ç›´ç·š", "time": "39:55", "status": "æœªé–‹å§‹", "note": "ç·šç·šé—œä¿‚"}
    ],
    "ç¬¬å››å†Š ç¬¬ä¸‰ç«  æ¢ä»¶æ©Ÿç‡(A+Bç‰ˆ)": [
        {"code": "3-1~3-2_ä¸»é¡Œ1", "name": "æ¢ä»¶æ©Ÿç‡", "time": "23:37", "status": "æœªé–‹å§‹", "note": "æ©Ÿç‡è¨ˆç®—"},
        {"code": "3-2_ä¸»é¡Œ2", "name": "ç¨ç«‹äº‹ä»¶", "time": "30:05", "status": "æœªé–‹å§‹", "note": "äº‹ä»¶ç¨ç«‹æ€§"},
        {"code": "3-3_ä¸»é¡Œ1", "name": "è²æ°å®šç†", "time": "27:36", "status": "æœªé–‹å§‹", "note": "å®šç†æ‡‰ç”¨"}
    ],
    "ç¬¬å››å†Š ç¬¬å››ç«  çŸ©é™£": [
        {"code": "4-1_ä¸»é¡Œ1", "name": "é«˜æ–¯æ¶ˆå»æ³•(Aç‰ˆ)", "time": "37:19", "status": "æœªé–‹å§‹", "note": "è§£æ–¹ç¨‹çµ„"},
        {"code": "4-2_ä¸»é¡Œ1", "name": "çŸ©é™£çš„åŠ æ¸›æ³•(A+Bç‰ˆ)", "time": "11:50", "status": "æœªé–‹å§‹", "note": "åŸºæœ¬é‹ç®—"},
        {"code": "4-2_ä¸»é¡Œ2", "name": "çŸ©é™£çš„ä¹˜æ³•(A+Bç‰ˆ)", "time": "21:19", "status": "æœªé–‹å§‹", "note": "ä¹˜æ³•é‹ç®—"},
        {"code": "4-2_ä¸»é¡Œ3", "name": "çŸ©é™£çš„é«˜æ¬¡æ–¹(A+Bç‰ˆ)", "time": "24:19", "status": "æœªé–‹å§‹", "note": "å†ªæ¬¡è¨ˆç®—"},
        {"code": "4-2_ä¸»é¡Œ4", "name": "åæ–¹é™£(A+Bç‰ˆ)", "time": "46:26", "status": "æœªé–‹å§‹", "note": "é€†çŸ©é™£"},
        {"code": "4-3_ä¸»é¡Œ1", "name": "è½‰ç§»çŸ©é™£(Aç‰ˆ)", "time": "38:11", "status": "æœªé–‹å§‹", "note": "ç‹€æ…‹è½‰ç§»"},
        {"code": "4-3_ä¸»é¡Œ2~3", "name": "å¹³é¢ç·šæ€§è®Šæ›(Aç‰ˆ)", "time": "10:19", "status": "æœªé–‹å§‹", "note": "å¹¾ä½•è®Šæ›"},
        {"code": "4-3_ä¸»é¡Œ4~5", "name": "ä¼¸ç¸®èˆ‡æ¨ç§»çŸ©é™£(Aç‰ˆ)", "time": "13:58", "status": "æœªé–‹å§‹", "note": "è®Šæ›çŸ©é™£"},
        {"code": "4-3_ä¸»é¡Œ6", "name": "é¡å°„çŸ©é™£(Aç‰ˆ)", "time": "12:17", "status": "æœªé–‹å§‹", "note": "å°ç¨±è®Šæ›"},
        {"code": "4-3_ä¸»é¡Œ7", "name": "æ—‹è½‰çŸ©é™£(Aç‰ˆ)", "time": "24:45", "status": "æœªé–‹å§‹", "note": "æ—‹è½‰è®Šæ›"}
    ]
}

# æº–å‚™ Excel è³‡æ–™
excel_data = []

for chapter_name, courses in course_data.items():
    # æ·»åŠ ç« ç¯€æ¨™é¡Œè¡Œ
    excel_data.append({
        'ç« ç¯€': chapter_name,
        'èª²ç¨‹ç·¨è™Ÿ': '',
        'èª²ç¨‹åç¨±': '',
        'æ™‚é•·': '',
        'ç‹€æ…‹': '',
        'å‚™è¨»': '',
        'å®Œæˆæ—¥æœŸ': ''
    })
    
    # æ·»åŠ èª²ç¨‹è³‡æ–™
    for course in courses:
        excel_data.append({
            'ç« ç¯€': '',
            'èª²ç¨‹ç·¨è™Ÿ': course['code'],
            'èª²ç¨‹åç¨±': course['name'],
            'æ™‚é•·': course['time'],
            'ç‹€æ…‹': course['status'],
            'å‚™è¨»': course['note'],
            'å®Œæˆæ—¥æœŸ': ''
        })

# å‰µå»º DataFrame
df = pd.DataFrame(excel_data)

# å‰µå»º Excel writer ç‰©ä»¶
with pd.ExcelWriter('æ•¸å­¸èª²ç¨‹é€²åº¦è¿½è¹¤è¡¨.xlsx', engine='openpyxl') as writer:
    # å¯«å…¥ä¸»è¦å·¥ä½œè¡¨
    df.to_excel(writer, sheet_name='èª²ç¨‹é€²åº¦', index=False)
    
    # ç²å–å·¥ä½œç°¿å’Œå·¥ä½œè¡¨
    workbook = writer.book
    worksheet = writer.sheets['èª²ç¨‹é€²åº¦']
    
    # è¨­ç½®æ¬„å¯¬
    worksheet.column_dimensions['A'].width = 25  # ç« ç¯€
    worksheet.column_dimensions['B'].width = 15  # èª²ç¨‹ç·¨è™Ÿ
    worksheet.column_dimensions['C'].width = 35  # èª²ç¨‹åç¨±
    worksheet.column_dimensions['D'].width = 10  # æ™‚é•·
    worksheet.column_dimensions['E'].width = 12  # ç‹€æ…‹
    worksheet.column_dimensions['F'].width = 20  # å‚™è¨»
    worksheet.column_dimensions['G'].width = 12  # å®Œæˆæ—¥æœŸ
    
    # å‰µå»ºæ¨£å¼
    from openpyxl.styles import PatternFill, Font, Alignment, Border, Side
    from openpyxl.worksheet.datavalidation import DataValidation
    
    # æ¨™é¡Œæ¨£å¼
    header_fill = PatternFill(start_color="217346", end_color="217346", fill_type="solid")
    header_font = Font(color="FFFFFF", bold=True)
    
    # ç« ç¯€æ¨™é¡Œæ¨£å¼
    chapter_fill = PatternFill(start_color="4472C4", end_color="4472C4", fill_type="solid")
    chapter_font = Font(color="FFFFFF", bold=True)
    
    # ç‹€æ…‹é¡è‰²
    completed_fill = PatternFill(start_color="D5E8D4", end_color="D5E8D4", fill_type="solid")
    progress_fill = PatternFill(start_color="FFF2CC", end_color="FFF2CC", fill_type="solid")
    not_started_fill = PatternFill(start_color="F8CECC", end_color="F8CECC", fill_type="solid")
    
    # é‚Šæ¡†æ¨£å¼
    thin_border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )
    
    # è¨­ç½®æ¨™é¡Œè¡Œæ¨£å¼
    for col in range(1, 8):
        cell = worksheet.cell(row=1, column=col)
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = Alignment(horizontal='center')
        cell.border = thin_border
    
    # è¨­ç½®ç‹€æ…‹ä¸‹æ‹‰é¸å–®
    status_validation = DataValidation(
        type="list",
        formula1='"æœªé–‹å§‹,é€²è¡Œä¸­,å·²å®Œæˆ"',
        allow_blank=False
    )
    status_validation.error = "è«‹é¸æ“‡ï¼šæœªé–‹å§‹ã€é€²è¡Œä¸­ã€å·²å®Œæˆ"
    status_validation.errorTitle = "ç„¡æ•ˆçš„ç‹€æ…‹"
    worksheet.add_data_validation(status_validation)
    status_validation.add(f'E2:E{len(excel_data)+1}')
    
    # è¨­ç½®è³‡æ–™æ¨£å¼
    for row_idx, row_data in enumerate(excel_data, start=2):
        # å¦‚æœæ˜¯ç« ç¯€æ¨™é¡Œè¡Œ
        if row_data['èª²ç¨‹ç·¨è™Ÿ'] == '':
            for col in range(1, 8):
                cell = worksheet.cell(row=row_idx, column=col)
                cell.fill = chapter_fill
                cell.font = chapter_font
                cell.alignment = Alignment(horizontal='center')
                cell.border = thin_border
        else:
            # èª²ç¨‹è³‡æ–™è¡Œ
            for col in range(1, 8):
                cell = worksheet.cell(row=row_idx, column=col)
                cell.border = thin_border
                cell.alignment = Alignment(horizontal='left')
                
                # ç‹€æ…‹æ¬„ç‰¹æ®Šè™•ç†
                if col == 5:  # ç‹€æ…‹æ¬„
                    status = cell.value
                    if status == 'å·²å®Œæˆ':
                        cell.fill = completed_fill
                    elif status == 'é€²è¡Œä¸­':
                        cell.fill = progress_fill
                    elif status == 'æœªé–‹å§‹':
                        cell.fill = not_started_fill
                    cell.alignment = Alignment(horizontal='center')
                
                # æ™‚é•·æ¬„ç½®ä¸­
                elif col == 4:  # æ™‚é•·æ¬„
                    cell.alignment = Alignment(horizontal='center')
    
    # å‰µå»ºçµ±è¨ˆå·¥ä½œè¡¨
    stats_data = [
        ['çµ±è¨ˆé …ç›®', 'æ•¸å€¼', 'å…¬å¼'],
        ['ç¸½èª²ç¨‹æ•¸', f'=COUNTA(èª²ç¨‹é€²åº¦.B:B)-1', 'è¨ˆç®—èª²ç¨‹ç·¨è™Ÿæ¬„ä½éç©ºå€¼'],
        ['å·²å®Œæˆèª²ç¨‹', f'=COUNTIF(èª²ç¨‹é€²åº¦.E:E,"å·²å®Œæˆ")', 'è¨ˆç®—ç‹€æ…‹ç‚º"å·²å®Œæˆ"çš„èª²ç¨‹'],
        ['é€²è¡Œä¸­èª²ç¨‹', f'=COUNTIF(èª²ç¨‹é€²åº¦.E:E,"é€²è¡Œä¸­")', 'è¨ˆç®—ç‹€æ…‹ç‚º"é€²è¡Œä¸­"çš„èª²ç¨‹'],
        ['æœªé–‹å§‹èª²ç¨‹', f'=COUNTIF(èª²ç¨‹é€²åº¦.E:E,"æœªé–‹å§‹")', 'è¨ˆç®—ç‹€æ…‹ç‚º"æœªé–‹å§‹"çš„èª²ç¨‹'],
        ['å®Œæˆç‡', f'=ROUND(C3/C2*100,1)&"%"', 'å·²å®Œæˆèª²ç¨‹æ•¸/ç¸½èª²ç¨‹æ•¸*100'],
        ['', '', ''],
        ['ç‹€æ…‹èªªæ˜', '', ''],
        ['å·²å®Œæˆ', 'èª²ç¨‹å·²å­¸ç¿’å®Œç•¢', ''],
        ['é€²è¡Œä¸­', 'èª²ç¨‹æ­£åœ¨å­¸ç¿’ä¸­', ''],
        ['æœªé–‹å§‹', 'èª²ç¨‹å°šæœªé–‹å§‹å­¸ç¿’', ''],
        ['', '', ''],
        ['ä½¿ç”¨èªªæ˜', '', ''],
        ['1. ç›´æ¥ä¿®æ”¹"ç‹€æ…‹"æ¬„ä½', 'ä½¿ç”¨ä¸‹æ‹‰é¸å–®é¸æ“‡', ''],
        ['2. å¡«å¯«"å®Œæˆæ—¥æœŸ"', 'æ ¼å¼ï¼šYYYY/MM/DD', ''],
        ['3. æ›´æ–°"å‚™è¨»"', 'è¨˜éŒ„å­¸ç¿’å¿ƒå¾—æˆ–é€²åº¦', ''],
        ['4. çµ±è¨ˆæœƒè‡ªå‹•è¨ˆç®—', 'ç„¡éœ€æ‰‹å‹•æ›´æ–°', '']
    ]
    
    stats_df = pd.DataFrame(stats_data[1:], columns=stats_data[0])
    stats_df.to_excel(writer, sheet_name='çµ±è¨ˆèˆ‡èªªæ˜', index=False)
    
    # è¨­ç½®çµ±è¨ˆå·¥ä½œè¡¨æ¨£å¼
    stats_worksheet = writer.sheets['çµ±è¨ˆèˆ‡èªªæ˜']
    stats_worksheet.column_dimensions['A'].width = 20
    stats_worksheet.column_dimensions['B'].width = 25
    stats_worksheet.column_dimensions['C'].width = 30
    
    # çµ±è¨ˆå·¥ä½œè¡¨æ¨™é¡Œæ¨£å¼
    for col in range(1, 4):
        cell = stats_worksheet.cell(row=1, column=col)
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = Alignment(horizontal='center')
        cell.border = thin_border

print("Excel æª”æ¡ˆå·²ç”Ÿæˆï¼šæ•¸å­¸èª²ç¨‹é€²åº¦è¿½è¹¤è¡¨.xlsx")
print("\nåŠŸèƒ½èªªæ˜ï¼š")
print("1. ğŸ“Š ä¸»è¦å·¥ä½œè¡¨ã€Œèª²ç¨‹é€²åº¦ã€- åŒ…å«æ‰€æœ‰èª²ç¨‹è³‡æ–™")
print("2. ğŸ“ˆ çµ±è¨ˆå·¥ä½œè¡¨ã€Œçµ±è¨ˆèˆ‡èªªæ˜ã€- è‡ªå‹•çµ±è¨ˆå’Œä½¿ç”¨èªªæ˜")
print("3. ğŸ¯ ç‹€æ…‹æ¬„ä½æœ‰ä¸‹æ‹‰é¸å–®ï¼šæœªé–‹å§‹ã€é€²è¡Œä¸­ã€å·²å®Œæˆ")
print("4. ğŸ¨ ç‹€æ…‹æœƒè‡ªå‹•é¡¯ç¤ºé¡è‰²ï¼šç¶ è‰²(å·²å®Œæˆ)ã€é»ƒè‰²(é€²è¡Œä¸­)ã€ç´…è‰²(æœªé–‹å§‹)")
print("5. ğŸ“Š çµ±è¨ˆæœƒæ ¹æ“šç‹€æ…‹æ¬„ä½è‡ªå‹•è¨ˆç®—")
print("\nä½¿ç”¨æ–¹å¼ï¼š")
print("- ç›´æ¥åœ¨Excelä¸­ä¿®æ”¹ã€Œç‹€æ…‹ã€æ¬„ä½")
print("- å¡«å¯«ã€Œå®Œæˆæ—¥æœŸã€å’Œã€Œå‚™è¨»ã€")
print("- çµ±è¨ˆæ•¸æ“šæœƒè‡ªå‹•æ›´æ–°")
